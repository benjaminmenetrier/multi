\documentclass[francais]{beamer}
\usepackage[francais]{babel}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage{amsmath, amssymb, amsfonts}




%CHOIX DU THEME et/ou DE SA COULEUR
% => essayer différents thèmes (en décommantant une des trois lignes suivantes)
%\usetheme{PaloAlto}
\usetheme{Madrid}

% => il est possible, pour un thème donné, de modifier seulement la couleur
\usecolortheme{default}
%\usecolortheme{whale}

%\useoutertheme[left]{sidebar}


%Pour le TITLEPAGE


\title[Nicolas Baillot d'Etivaux]{}


%Debut de la presentation :

\begin{document}


%Présentation:
\setbeamertemplate{blocks}[rounded]%
[shadow=false]


\begin{frame}{Content}
\begin{itemize}
\item Added features
\item Comparision between linear and non linear H
\item Comparision between interpolation methods with/without projective B matrix
\end{itemize}
\end{frame}


\begin{frame}{Added features}
\begin{itemize}
 \item Cubic H operator and adjoint:
 \begin{itemize}
  \item $H_{nl}$: 1) $x \rightarrow x^3$, 2) interpolation on obs points.
  \item $H$: 1) $x \rightarrow 3 x^g  x^g  x^3$, 2) interpolation on obs points.
  \item $H^*$: 1) interpolation on grid points, 2) $x \rightarrow 3 x^g  x^g  x^3$. 
 \end{itemize}
 \vspace{+0.2cm}
 \item Truth:\\
  1) $x^t = \textrm{rand\_normal}(n_h)$.\\
  2) $x^t = B^{1/2} x^t$.
  \vspace{+0.2cm}
 \item Observations from the truth:\\
     $y = H x^t + N(0,\sigma^o)$.
 \vspace{+0.2cm}
 \item Nearest Neighbor interpolation.    
\end{itemize}
\end{frame}


%------------------------------------------------------------------------------------------
\begin{frame}{Check the observations from $x^t$}
\begin{center}
$ \sigma^o = 0.001$\\ 
\begin{figure}
\minipage{0.49\textwidth}
  \includegraphics[width=0.95\linewidth]{img/xt.png}
  \caption{$x^t$}
\endminipage\hfill
\minipage{0.49\textwidth}
  \includegraphics[width=0.95\linewidth]{img/obs.png}
  \caption{Obs with a linear H}
\endminipage
\end{figure}
\end{center}
\end{frame}

\begin{frame}{Check the observations from $x^t$}
\begin{center}
$ \sigma^o = 0.001$\\ 
\begin{figure}
\minipage{0.49\textwidth}
  \includegraphics[width=0.95\linewidth]{img/xt.png}
  \caption{$x^t$}
\endminipage\hfill
\minipage{0.49\textwidth}
  \includegraphics[width=0.95\linewidth]{img/obs_nl.png}
  \caption{Obs with a cubic H}
\endminipage
\end{figure}
\end{center}
\end{frame}

%------------------------------------------------------------------------------------------
\begin{frame}{Comparision between linear and non linear H: $J^o$}
\begin{center}
$n_x=n_y=23,51,101 ; \sigma^o = 0.001 ; \sigma^b_{var} = 0 ; L_b = 0.1 ; n_{obs}=300$.\\
Linear case:\\
\includegraphics[scale=0.3]{./img/Hcomp/jo_linear300.png}
\end{center}
\end{frame}

\begin{frame}{Comparision between linear and non linear H:$J^o$}
\begin{center}
$n_x=n_y=23,51,101 ; \sigma^o = 0.001 ; \sigma^b_{var} = 0 ; L_b = 0.1 ; n_{obs}=300$.\\
Cubic case:\\
\includegraphics[scale=0.3]{./img/Hcomp/jo_nl300.png}
\end{center}
\end{frame}

\begin{frame}{Comparision between linear and non linear H:$J^o_{nl}$}
\begin{center}
$n_x=n_y=23,51,101 ; \sigma^o = 0.001 ; \sigma^b_{var} = 0 ; L_b = 0.1 ; n_{obs}=300$.\\
Cubic case:\\
\includegraphics[scale=0.3]{./img/Hcomp/jo_nl_nl300.png}
\end{center}
\end{frame}
%------------------------------------------------------------------------------------------


\begin{frame}
\begin{center}
\huge{Projective B-matrix}
\end{center}
\end{frame}

\begin{frame}{Projective B matrix: nearest interpolation: $J^o$}
\begin{center}
$n_x=n_y=23,51,101 ; \sigma^o = 0.001 ; \sigma^b_{var} = 0 ; L_b = 0.1 ; n_{obs}=300$.\\
Linear case:\\
\includegraphics[scale=0.3]{./img/projB/near/jo_linear_T.png}
\end{center}
\end{frame}
\begin{frame}{Projective B matrix: nearest interpolation: $J^b$}
\begin{center}
$n_x=n_y=23,51,101 ; \sigma^o = 0.001 ; \sigma^b_{var} = 0 ; L_b = 0.1 ; n_{obs}=300$.\\
Linear case:\\
\includegraphics[scale=0.3]{./img/projB/near/jb_linear_T.png}
\end{center}
\end{frame}

\begin{frame}{Projective B matrix: bilinear interpolation: $J^o$}
\begin{center}
$n_x=n_y=23,51,101 ; \sigma^o = 0.001 ; \sigma^b_{var} = 0 ; L_b = 0.1 ; n_{obs}=300$.\\
Linear case:\\
\includegraphics[scale=0.3]{./img/projB/bil/jo_linear_T.png}
\end{center}
\end{frame}

\begin{frame}{Projective B matrix: bilinear interpolation: $J^b$}
\begin{center}
$n_x=n_y=23,51,101 ; \sigma^o = 0.001 ; \sigma^b_{var} = 0 ; L_b = 0.1 ; n_{obs}=300$.\\
Linear case:\\
\includegraphics[scale=0.3]{./img/projB/bil/jb_linear_T.png}
\end{center}
\end{frame}

%------------------------------------------------------------------------------------------


\begin{frame}
\begin{center}
\huge{Non projective B-matrix}
\end{center}
\end{frame}

\begin{frame}{Non projective B matrix: spectral interpolation: $J^o$}
\begin{center}
$n_x=n_y=23,51,101 ; \sigma^o = 0.001 ; \sigma^b_{var} = 0 ; L_b = 0.1 ; n_{obs}=300$.\\
Linear case:\\
\includegraphics[scale=0.3]{./img/projB/spec/jo_linear_F.png}
\end{center}
\end{frame}
\begin{frame}{Non projective B matrix: spectral interpolation: $J^b$}
\begin{center}
$n_x=n_y=23,51,101 ; \sigma^o = 0.001 ; \sigma^b_{var} = 0 ; L_b = 0.1 ; n_{obs}=300$.\\
Linear case:\\
\includegraphics[scale=0.3]{./img/projB/spec/jb_linear_F.png}
\end{center}
\end{frame}

\begin{frame}{Non projective B matrix: bilinear interpolation: $J^o$}
\begin{center}
$n_x=n_y=23,51,101 ; \sigma^o = 0.001 ; \sigma^b_{var} = 0 ; L_b = 0.1 ; n_{obs}=300$.\\
Linear case:\\
\includegraphics[scale=0.3]{./img/projB/bil/jo_linear_F.png}
\end{center}
\end{frame}
\begin{frame}{Non projective B matrix: bilinear interpolation: $J^b$}
\begin{center}
$n_x=n_y=23,51,101 ; \sigma^o = 0.001 ; \sigma^b_{var} = 0 ; L_b = 0.1 ; n_{obs}=300$.\\
Linear case:\\
\includegraphics[scale=0.3]{./img/projB/bil/jb_linear_F.png}
\end{center}
\end{frame}

\begin{frame}{Non projective B matrix: nearest interpolation: $J^o$}
\begin{center}
$n_x=n_y=23,51,101 ; \sigma^o = 0.001 ; \sigma^b_{var} = 0 ; L_b = 0.1 ; n_{obs}=300$.\\
Linear case:\\
\includegraphics[scale=0.3]{./img/projB/near/jo_linear_F.png}
\end{center}
\end{frame}
\begin{frame}{Non projective B matrix: nearest interpolation: $J^b$}
\begin{center}
$n_x=n_y=23,51,101 ; \sigma^o = 0.001 ; \sigma^b_{var} = 0 ; L_b = 0.1 ; n_{obs}=300$.\\
Linear case:\\
\includegraphics[scale=0.3]{./img/projB/near/jb_linear_F.png}
\end{center}
\end{frame}

%------------------------------------------------------------------------------------------

\begin{frame}
\begin{center}
\huge{Non projective B-matrix with cubic H}
\end{center}
\end{frame}

\begin{frame}{Non projective B matrix: spectral interpolation: $J$}
\begin{center}
$n_x=n_y=23,51,101 ; \sigma^o = 0.001 ; \sigma^b_{var} = 0 ; L_b = 0.1 ; n_{obs}=300$.\\
cubic case:\\
\includegraphics[scale=0.3]{./img/projB/spec/j_cubic_F.png}
\end{center}
\end{frame}

\begin{frame}{Non projective B matrix: spectral interpolation: $J^o_nl$}
\begin{center}
$n_x=n_y=23,51,101 ; \sigma^o = 0.001 ; \sigma^b_{var} = 0 ; L_b = 0.1 ; n_{obs}=300$.\\
cubic case:\\
\includegraphics[scale=0.3]{./img/projB/spec/jo_nl_cubic_F.png}
\end{center}
\end{frame}

\begin{frame}{Non projective B matrix: spectral interpolation: $J^o$}
\begin{center}
$n_x=n_y=23,51,101 ; \sigma^o = 0.001 ; \sigma^b_{var} = 0 ; L_b = 0.1 ; n_{obs}=300$.\\
cubic case:\\
\includegraphics[scale=0.3]{./img/projB/spec/jo_cubic_F.png}
\end{center}
\end{frame}

\begin{frame}{Non projective B matrix: spectral interpolation: $J^b$}
\begin{center}
$n_x=n_y=23,51,101 ; \sigma^o = 0.001 ; \sigma^b_{var} = 0 ; L_b = 0.1 ; n_{obs}=300$.\\
cubic case:\\
\includegraphics[scale=0.3]{./img/projB/spec/jb_cubic_F.png}
\end{center}
\end{frame}


% Conclusions ------------------------------------------------------------------------------------------
\begin{frame}{Short conclusion and questions:}
\begin{itemize}
\item As expected: The only way to get no differences between the methods (th, std, alt) is to have a transitive interpolation AND the projective B matrix condition.\\
\item There is often a change of variation at the first inner loop level (except for the first outer loop).\\
\item Nearest neighbor interpolation seems not transitive (?) (+periodic domain ? + very slow...)\\
\item Similar behaviour with H measuring $x^4$ (not shown).
\item Question: What happens if two observations are interpolated at the same grid point with the bilinear and nearest neighbor interpolations ?
\item Question: equation 38 from the notes.
\end{itemize}
\end{frame}
%------------------------------------------------------------------------------------------


\usebackgroundtemplate{}




\end{document}
